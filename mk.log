
ifndef __mk_log_included
__mk_log_included := true

mk_PARAMETERS  += LOG LOG_FILE
mk_TARGET_list += log
mk_logged_cmd   = @echo $1 $(__log) && $1 $(__log)


#-- parameters ...

LOG_doc          ?= switch to enable/disable logging {on, off}
LOG_default       = on
mk_LOG            = $(call mk_get,LOG)

LOG_FILE_doc     ?= file for logging build messages.
LOG_FILE_default  = $(mk_BUILD_DIR)/_log.txt
mk_LOG_FILE       = $(call mk_get,LOG_FILE)

#-- targets ...

log_doc = show the logged command output via less
log:
	@less $(mk_LOG_FILE)

#-- definitions for build step logging ...

__log_on  = 2>&1 | tee -a $(mk_LOG_FILE)
__log_off =
__log     = $(__log_$(mk_LOG))

endif # __mk_log_included

